import numpy as np
import matplotlib.pyplot as plt

# Tạo trục theta từ 0 đến 2π
theta = np.linspace(0, 2 * np.pi, 1000)

# Tạo các điện áp pha lệch nhau 120 độ
ua = np.sin(theta)
ub = np.sin(theta - 2 * np.pi / 3)
uc = np.sin(theta + 2 * np.pi / 3)

# Điện áp sau chỉnh lưu nửa chu kỳ: là max của 3 pha
ud = np.maximum.reduce([ua, ub, uc])

# Vẽ các đường sin
plt.figure(figsize=(12, 6))
plt.plot(theta, ua, 'r', label='$u_a$')
plt.plot(theta, ub, 'g', label='$u_b$')
plt.plot(theta, uc, 'b', label='$u_c$')
plt.plot(theta, ud, 'k', linewidth=2, label='$u_d = \max(u_a, u_b, u_c)$')

# Ghi nhãn một số điểm
for t, label in zip([np.pi/6, 5*np.pi/6, np.pi, 2*np.pi],
                    ['M', 'N', 'L', 'P']):
    plt.axvline(x=t, color='gray', linestyle='--', linewidth=0.7)
    plt.text(t, 1.05, label, ha='center', fontsize=10)

# Ghi nhãn theta1...theta4 (đoạn chia D1, D2, D3)
theta_marks = [0.5, 2.4, 4.3, 6.1]
for i, t in enumerate(theta_marks, start=1):
    plt.axvline(x=t, color='gray', linestyle=':', linewidth=0.6)
    plt.text(t, -1.2, f'$\\theta_{i}$', ha='center', fontsize=10)

# Đặt nhãn trục
plt.xlabel('$\\theta$', fontsize=14)
plt.ylabel('u', fontsize=14)
plt.title('Biểu đồ điện áp 3 pha và điện áp chỉnh lưu nửa chu kỳ', fontsize=14)
plt.grid(True)
plt.legend()
plt.ylim(-1.5, 1.2)
plt.xlim(0, 2 * np.pi)

plt.show()
